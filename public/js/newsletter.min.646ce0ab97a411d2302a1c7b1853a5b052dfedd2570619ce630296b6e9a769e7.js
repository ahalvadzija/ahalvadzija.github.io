const SB_URL=window.supabaseConfig.url,SB_KEY=window.supabaseConfig.key,_supabase=supabase.createClient(SB_URL,SB_KEY);async function handleSubscription(){const n=document.getElementById("sub-name"),s=document.getElementById("sub-email"),t=document.getElementById("sub-button"),e=document.getElementById("form-msg"),o=n.value.trim(),i=s.value.trim();if([n,s].forEach(e=>e.style.borderColor="var(--border)"),e.classList.add("hidden"),o.length<2){showError(n,"Please enter your name");return}const a=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;if(!a.test(i)){showError(s,"Please enter a valid email address");return}t.disabled=!0;const r=t.innerText;t.innerText="Wait...";try{const{error:n}=await _supabase.from("newsletter_subscribers").insert([{name:o,email:i}]);if(n)throw n;e.innerText="✓ Welcome to the list!",e.style.color="#3182ce",e.classList.remove("hidden"),document.getElementById("newsletter-form").reset(),t.innerText="Done!"}catch(n){n.code==="23505"?e.innerText="✗ You're already on the list! ✨":e.innerText="✗ Error: "+(n.message||"Something went wrong"),e.style.color="#ef4444",e.classList.remove("hidden"),t.disabled=!1,t.innerText=r}}function showError(e,t){const n=document.getElementById("form-msg");e.style.borderColor="#ef4444",e.focus(),n.innerText="✗ "+t,n.style.color="#ef4444",n.classList.remove("hidden")}